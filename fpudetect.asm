.include "monitor.inc"

	ORG	$00000400

START:
	LEA	INTRO,A0
	JSR	PUTS

	LEA	NO,A0

	MOVE.L	$10,IISAVED.L
	MOVE.L	#IIHANDLER,$2C		; LINE-F TRAP
	MOVE.L	#CONTINUE,CONTADDR.L
	CLR.B	IIFLAG.L

	FNOP

CONTINUE:
	TST.B	IIFLAG.L
	BNE	1f
	LEA	YES,A0
1:	JSR	PUTS
	LEA	CRLF,A0
	JSR	PUTS

	MOVE.L	IISAVED,$2C

	JMP	MONITR

IIHANDLER:
	MOVE.B	#1,IIFLAG.L	; Set the flag
	MOVE.L	CONTADDR,2(SP)	; Update continue PC

	RTE

	.BALIGN	4
CONTADDR	DC.L	0
IISAVED		DC.L	0
IIFLAG		DC.B	0 

	.BALIGN	4
INTRO		DC.B	"Detecting FPU... ",0
YES		DC.B	"Yes",0
NO		DC.B	"No",0
CRLF		DC.B	"\r\n",0

	END
